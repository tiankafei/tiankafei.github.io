(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{378:function(s,t,a){"use strict";a.r(t);var e=a(25),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"centos7安装多版本多实例mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos7安装多版本多实例mysql"}},[s._v("#")]),s._v(" centos7安装多版本多实例mysql")]),s._v(" "),t("h2",{attrs:{id:"安装前的准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装前的准备工作"}},[s._v("#")]),s._v(" 安装前的准备工作")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/software\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /opt/mysql\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# MySQL安装目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/mysql/app\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# MySQL数据目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/mysql/330"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7,8")]),s._v(",9"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/data\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/mysql/33"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17,18")]),s._v(",19"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Scoket目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/mysql/socket\n")])])]),t("h2",{attrs:{id:"上传mysql的解压包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传mysql的解压包"}},[s._v("#")]),s._v(" 上传mysql的解压包")]),s._v(" "),t("h2",{attrs:{id:"安装mysql5-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql5-7"}},[s._v("#")]),s._v(" 安装mysql5.7")]),s._v(" "),t("h3",{attrs:{id:"解压"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解压"}},[s._v("#")]),s._v(" 解压")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压mysql")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/software\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf mysql-5.7.39-el7-x86_64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /opt/software/mysql-5.7.39-el7-x86_64 /opt/mysql/app/mysql-5.7.39\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /opt/mysql/app/mysql-5.7.39 /opt/mysql/app/mysql5739\n")])])]),t("h3",{attrs:{id:"实例配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例配置文件"}},[s._v("#")]),s._v(" 实例配置文件")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3307实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3307/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_log_file_size=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql5739\ndatadir=/opt/mysql/3307/data\nsocket=/opt/mysql/socket/mysql3307.sock\nlog-error=/opt/mysql/3307/mysql.log\nlog_bin=/opt/mysql/3307/mysql-bin\nbinlog_format=row\nport=3307\nserver_id=7\nmax_connect_errors=500\nmax_connections=1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3308实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3308/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_log_file_size=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql5739\ndatadir=/opt/mysql/3308/data\nsocket=/opt/mysql/socket/mysql3308.sock\nlog-error=/opt/mysql/3308/mysql.log\nlog_bin=/opt/mysql/3308/mysql-bin\nbinlog_format=row\nport=3308\nserver_id=8\nmax_connect_errors=500\nmax_connections=1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3309实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3309/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_log_file_size=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql5739\ndatadir=/opt/mysql/3309/data\nsocket=/opt/mysql/socket/mysql3309.sock\nlog-error=/opt/mysql/3309/mysql.log\nlog_bin=/opt/mysql/3309/mysql-bin\nbinlog_format=row\nport=3309\nserver_id=9\nmax_connect_errors=500\nmax_connections=1000\nEOF")]),s._v("\n")])])]),t("h3",{attrs:{id:"创建用户并授权"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户并授权"}},[s._v("#")]),s._v(" 创建用户并授权")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /sbin/nologin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" mysql\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" mysql\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql.mysql /opt/mysql\n")])])]),t("h3",{attrs:{id:"初始化数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化数据库"}},[s._v("#")]),s._v(" 初始化数据库")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3307初始化数据库")]),s._v("\n/opt/mysql/app/mysql5739/bin/mysqld --initialize-insecure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql5739 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3307/data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3308初始化数据库")]),s._v("\n/opt/mysql/app/mysql5739/bin/mysqld --initialize-insecure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql5739 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3308/data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3309初始化数据库")]),s._v("\n/opt/mysql/app/mysql5739/bin/mysqld --initialize-insecure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql5739 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3309/data\n")])])]),t("h3",{attrs:{id:"创建实例启动的服务脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建实例启动的服务脚本"}},[s._v("#")]),s._v(" 创建实例启动的服务脚本")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3307实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3307.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql5739/bin/mysqld --defaults-file=/opt/mysql/3307/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3308实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3308.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql5739/bin/mysqld --defaults-file=/opt/mysql/3308/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3309实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3309.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql5739/bin/mysqld --defaults-file=/opt/mysql/3309/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n")])])]),t("h3",{attrs:{id:"服务启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务启动"}},[s._v("#")]),s._v(" 服务启动")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("systemctl daemon-reload\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务启动")]),s._v("\nsystemctl start mysqld3307\nsystemctl start mysqld3308\nsystemctl start mysqld3309\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端口监控")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -lntup"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld\n")])])]),t("h3",{attrs:{id:"命令行登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令行登录"}},[s._v("#")]),s._v(" 命令行登录")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令行登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/mysql/app/mysql5739/bin\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3307")]),s._v("\n\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3308")]),s._v("\n\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3309")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新密码")]),s._v("\nalter user user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" identified by "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Root_12root'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nALTER "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tiankafei'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nuse mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nupdate user "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" where user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" host, user from user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nflush privileges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"设置开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置开机启动"}},[s._v("#")]),s._v(" 设置开机启动")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动")]),s._v("\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3307\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3308\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3309\n")])])]),t("h2",{attrs:{id:"安装mysql8-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql8-0"}},[s._v("#")]),s._v(" 安装mysql8.0")]),s._v(" "),t("h3",{attrs:{id:"解压-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解压-2"}},[s._v("#")]),s._v(" 解压")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压mysql")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/software\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf mysql-8.0.30-el7-x86_64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /opt/software/mysql-8.0.30-el7-x86_64 /opt/mysql/app/mysql-8.0.30\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /opt/mysql/app/mysql-8.0.30 /opt/mysql/app/mysql8030\n")])])]),t("h3",{attrs:{id:"实例配置文件-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例配置文件-2"}},[s._v("#")]),s._v(" 实例配置文件")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3317实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3317/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_redo_log_capacity=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql8030\ndatadir=/opt/mysql/3317/data\nsocket=/opt/mysql/socket/mysql3317.sock\nlog-error=/opt/mysql/3317/mysql.log\nlog_bin=/opt/mysql/3317/mysql-bin\nbinlog_format=row\nport=3317\nmysqlx_port=33317\nmysqlx_socket=/opt/mysql/socket/mysql33317.sock\nmax_connect_errors=500\nmax_connections=1000\nserver_id=17\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3318实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3318/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_redo_log_capacity=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql8030\ndatadir=/opt/mysql/3318/data\nsocket=/opt/mysql/socket/mysql3318.sock\nlog-error=/opt/mysql/3318/mysql.log\nlog_bin=/opt/mysql/3318/mysql-bin\nbinlog_format=row\nport=3318\nmysqlx_port=33318\nmysqlx_socket=/opt/mysql/socket/mysql33318.sock\nmax_connect_errors=500\nmax_connections=1000\nserver_id=18\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3319实例配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/mysql/3319/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[mysqld]\nuser=mysql\nlower_case_table_names=1\ndefault-storage-engine=INNODB\ncharacter_set_server=utf8mb4\ncollation-server=utf8mb4_bin\nmax_allowed_packet=256M\ninnodb_redo_log_capacity=256M\ninnodb_default_row_format=DYNAMIC\nbasedir=/opt/mysql/app/mysql8030\ndatadir=/opt/mysql/3319/data\nsocket=/opt/mysql/socket/mysql3319.sock\nlog-error=/opt/mysql/3319/mysql.log\nlog_bin=/opt/mysql/3319/mysql-bin\nbinlog_format=row\nport=3319\nmysqlx_port=33319\nmysqlx_socket=/opt/mysql/socket/mysql33319.sock\nmax_connect_errors=500\nmax_connections=1000\nserver_id=19\nEOF")]),s._v("\n")])])]),t("h3",{attrs:{id:"初始化数据库-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化数据库-2"}},[s._v("#")]),s._v(" 初始化数据库")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" perl-DBD-MySQL perl-Config-Tiny epel-release perl-Log-Dispatch perl-Parallel-ForkManager perl-Time-HiRes\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化3317数据库")]),s._v("\n/opt/mysql/app/mysql8030/bin/mysqld --initialize-insecure --lower-case-table-names"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql8030 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3317/data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化3318数据库")]),s._v("\n/opt/mysql/app/mysql8030/bin/mysqld --initialize-insecure --lower-case-table-names"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql8030 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3318/data\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化3319数据库")]),s._v("\n/opt/mysql/app/mysql8030/bin/mysqld --initialize-insecure --lower-case-table-names"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/app/mysql8030 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/mysql/3319/data\n")])])]),t("h3",{attrs:{id:"创建实例启动的服务脚本-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建实例启动的服务脚本-2"}},[s._v("#")]),s._v(" 创建实例启动的服务脚本")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3317实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3317.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql8030/bin/mysqld --defaults-file=/opt/mysql/3317/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3318实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3318.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql8030/bin/mysqld --defaults-file=/opt/mysql/3318/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3319实例启动的服务脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/systemd/system/mysqld3319.service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=MySQL Server\nDocumentation=man:mysqld(8)\nDocumentation=http://dev.mysql.com/doc/refman/en/using-systemd.html\nAfter=network.target\nAfter=syslog.target\n[Install]\nWantedBy=multi-user.target\n[Service]\nUser=mysql\nGroup=mysql\nExecStart=/opt/mysql/app/mysql8030/bin/mysqld --defaults-file=/opt/mysql/3319/my.cnf\nLimitNOFILE = 1000\nEOF")]),s._v("\n")])])]),t("h3",{attrs:{id:"服务启动-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务启动-2"}},[s._v("#")]),s._v(" 服务启动")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("systemctl daemon-reload\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务启动")]),s._v("\nsystemctl start mysqld3317\nsystemctl start mysqld3318\nsystemctl start mysqld3319\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端口监控")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -lntup"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld\n")])])]),t("h3",{attrs:{id:"命令行登录-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令行登录-2"}},[s._v("#")]),s._v(" 命令行登录")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/mysql/app/mysql8030/bin\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3317")]),s._v("\n\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3318")]),s._v("\n\n./mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3319")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新密码")]),s._v("\nalter user user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" identified by "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Root_12root'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nSHOW VARIABLES LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'validate_password%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" global "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("validate_password.policy")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" global "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("validate_password.length")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nALTER "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tiankafei'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nuse mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nupdate user "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" where user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" host, user from user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nflush privileges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"设置开机启动-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置开机启动-2"}},[s._v("#")]),s._v(" 设置开机启动")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动")]),s._v("\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3317\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3318\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld3319\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);