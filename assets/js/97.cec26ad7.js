(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{368:function(a,s,t){"use strict";t.r(s);var e=t(13),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"centos7安装scala"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#centos7安装scala"}},[a._v("#")]),a._v(" Centos7安装Scala")]),a._v(" "),s("h2",{attrs:{id:"下载scala"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载scala"}},[a._v("#")]),a._v(" 下载Scala")]),a._v(" "),s("p",[a._v("选择对应的版本进行下载，这里选择的是2.12.11")]),a._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[a._v("# scala所有版本列表\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//www.scala-lang.org/download/all.html")])]),a._v("\n# rpm 安装包下载路径\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//downloads.lightbend.com/scala/2.12.11/scala-2.12.11.rpm")])]),a._v("\n# tgz 解压包下载路径\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//downloads.lightbend.com/scala/2.12.11/scala-2.12.11.tgz")])]),a._v("\n")])])]),s("h2",{attrs:{id:"安装配置scala"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装配置scala"}},[a._v("#")]),a._v(" 安装配置Scala")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("rpm -i scala-2.12.11.rpm\n")])])]),s("h2",{attrs:{id:"设置环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量"}},[a._v("#")]),a._v(" 设置环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("vim/etc/profile\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SCALA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/share/scala\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SCALA_HOME")]),a._v("/bin\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])])]),s("h1",{attrs:{id:"centos7安装配置spark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#centos7安装配置spark"}},[a._v("#")]),a._v(" centos7安装配置Spark")]),a._v(" "),s("h2",{attrs:{id:"下载spark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载spark"}},[a._v("#")]),a._v(" 下载Spark")]),a._v(" "),s("p",[a._v("选择对应的版本进行下载，这里选择的是： spark-2.4.5-bin-hadoop2.7")]),a._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[a._v("# spark全部版本下载地址\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//spark.apache.org/news/index.html")])]),a._v("\n# tgz 解压包下载路径\n"),s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//mirrors.tuna.tsinghua.edu.cn/apache/spark/spark-2.4.5/spark-2.4.5-bin-hadoop2.7.tgz")])]),a._v("\n")])])]),s("h2",{attrs:{id:"spark单机版安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark单机版安装"}},[a._v("#")]),a._v(" Spark单机版安装")]),a._v(" "),s("h3",{attrs:{id:"解压到指定路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解压到指定路径"}},[a._v("#")]),a._v(" 解压到指定路径")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /opt/bigdata/spark-2.4.5-local\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zvxf")]),a._v(" spark-2.4.5-bin-hadoop2.7.tgz "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" /opt/bigdata/spark-2.4.5-local\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-local\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" spark-2.4.5-bin-hadoop2.7/* /opt/bigdata/spark-2.4.5-local/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" spark-2.4.5-bin-hadoop2.7/\n")])])]),s("h3",{attrs:{id:"设置环境变量-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量-2"}},[a._v("#")]),a._v(" 设置环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("vim/etc/profile\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/bigdata/spark-2.4.5-local\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/bin:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])])]),s("h3",{attrs:{id:"单机启动测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单机启动测试"}},[a._v("#")]),a._v(" 单机启动测试")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入spark的sbin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-local/sbin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 执行命令启动spark的master节点")]),a._v("\n./start-master.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动完成之后访问地址")]),a._v("\nhttp://bigdata01:8080\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入spark的bin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-local/bin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用spark-shell 连接测试")]),a._v("\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" spark://bigdata01:7077\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果出现scala的命令行窗口模式，则说明连接成功，至此单机版的spark安装测试完成")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入spark的sbin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-local/sbin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止单机版的Spark单机主程序")]),a._v("\n./stop-master.sh\n")])])]),s("h2",{attrs:{id:"spark集群高可用安装-on-master"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark集群高可用安装-on-master"}},[a._v("#")]),a._v(" Spark集群高可用安装-on-master")]),a._v(" "),s("h3",{attrs:{id:"解压到指定路径-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解压到指定路径-2"}},[a._v("#")]),a._v(" 解压到指定路径")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /opt/bigdata/spark-2.4.5-master\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zvxf")]),a._v(" spark-2.4.5-bin-hadoop2.7.tgz "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" /opt/bigdata/spark-2.4.5-master\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-master\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" spark-2.4.5-bin-hadoop2.7/* /opt/bigdata/spark-2.4.5-master/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" spark-2.4.5-bin-hadoop2.7/\n")])])]),s("h3",{attrs:{id:"设置环境变量-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量-3"}},[a._v("#")]),a._v(" 设置环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("vim/etc/profile\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/bigdata/spark-2.4.5-master\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/bin:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])])]),s("div",{staticClass:"language-shelll extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("reboot\n")])])]),s("h3",{attrs:{id:"执行配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行配置"}},[a._v("#")]),a._v(" 执行配置")]),a._v(" "),s("p",[a._v("cd $SPARK_HOME/conf")]),a._v(" "),s("blockquote",[s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" slaves.template slaves\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" slaves\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("bigdata02\nbigdata03\nbigdata04\n")])])])]),a._v(" "),s("blockquote",[s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" spark-env.sh.template spark-env.sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-env.sh\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("HADOOP_CONF_DIR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/bigdata/hadoop-2.8.3-ha/hadoop-2.8.3/etc/hadoop\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_MASTER_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("bigdata01   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 每台master改成自己的主机名")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_MASTER_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7077")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_MASTER_WEBUI_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_WORKER_CORES")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_WORKER_MEMORY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("4g\n")])])])]),a._v(" "),s("h3",{attrs:{id:"向其他机器分发配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#向其他机器分发配置"}},[a._v("#")]),a._v(" 向其他机器分发配置")]),a._v(" "),s("p",[a._v("cd $SPARK_HOME/conf")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" slaves spark-env.sh bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" slaves spark-env.sh bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" slaves spark-env.sh bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])])]),s("h3",{attrs:{id:"执行启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行启动"}},[a._v("#")]),a._v(" 执行启动")]),a._v(" "),s("h4",{attrs:{id:"启动hadoop集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动hadoop集群"}},[a._v("#")]),a._v(" 启动hadoop集群")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 所有机器启动zookeeper")]),a._v("\nzkServer.sh start\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看zookeeper状态")]),a._v("\nzkServer.sh status\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 resourcemanager 角色")]),a._v("\nyarn-daemons.sh start resourcemanager\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 hdfs 集群")]),a._v("\nstart-dfs.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 NodeManager 角色")]),a._v("\nstart-yarn.sh\n")])])]),s("h4",{attrs:{id:"启动spark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动spark"}},[a._v("#")]),a._v(" 启动Spark")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入 spark 的 sbin 目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-master/sbin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 执行启动命令")]),a._v("\n./start-all.sh\n")])])]),s("h4",{attrs:{id:"spark资源层角色为"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark资源层角色为"}},[a._v("#")]),a._v(" Spark资源层角色为")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("主节点：Master\n从节点：Worker\n")])])]),s("h4",{attrs:{id:"spark资源层webui访问url"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark资源层webui访问url"}},[a._v("#")]),a._v(" Spark资源层webUI访问url")]),a._v(" "),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token header"}},[s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[a._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token header-value"}},[a._v("//bigdata01:8080")])]),a._v("\n")])])]),s("h4",{attrs:{id:"集群应用测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集群应用测试"}},[a._v("#")]),a._v(" 集群应用测试")]),a._v(" "),s("h5",{attrs:{id:"生成本地文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成本地文件"}},[a._v("#")]),a._v(" 生成本地文件")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("vimdata.txt\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hello world\nhello mashibing\nhello spark\ngood idea\n")])])]),s("h5",{attrs:{id:"文件上传到hdfs上"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件上传到hdfs上"}},[a._v("#")]),a._v(" 文件上传到hdfs上")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# hdfs上创建目录")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /sparktest\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文本文件上传")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-put")]),a._v(" data.txt /sparktest\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看文件是否上传成功")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /sparktest\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 或者访问url")]),a._v("\nhttp://bigdata01:50070/explorer.html\n")])])]),s("h5",{attrs:{id:"测试spark程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试spark程序"}},[a._v("#")]),a._v(" 测试spark程序")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入Spark的bin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-master/bin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看帮助")]),a._v("\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--help")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用spark-shell进行测试")]),a._v("\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" spark://bigdata01:7077\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动完成之后，可以从spark资源ui管理界面看到相对应的application")]),a._v("\nhttp://bigdata01:8080\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 执行scala测试语句")]),a._v("\nsc.textFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://mycluster/sparktest/data.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".flatMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_.split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v(".map"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("((")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")])]),a._v(".reduceByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_+_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".collect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".foreach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("println"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h3",{attrs:{id:"设置zookeeper高可用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置zookeeper高可用"}},[a._v("#")]),a._v(" 设置zookeeper高可用")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入 Spark 的配置文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-master/conf\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 赋值模版文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" spark-defaults.conf.template spark-defaults.conf\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 编辑spark-defaults.conf")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-defaults.conf\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("spark.deploy.recoveryMode       ZOOKEEPER\nspark.deploy.zookeeper.url      bigdata01:2181,bigdata02:2181,bigdata03:2181,bigdata04:2181\nspark.deploy.zookeeper.dir      /spark\n")])])]),s("h3",{attrs:{id:"向其他机器分发配置-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#向其他机器分发配置-2"}},[a._v("#")]),a._v(" 向其他机器分发配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n")])])]),s("h3",{attrs:{id:"进入第二台机器-修改配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进入第二台机器-修改配置"}},[a._v("#")]),a._v(" 进入第二台机器，修改配置")]),a._v(" "),s("p",[a._v("cd $SPARK_HOME/conf")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-env.sh\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_MASTER_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("bigdata02   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 每台master改成自己的主机名")]),a._v("\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重启Spark集群")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止Spark")]),a._v("\n./stop-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 再次启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 进入第一台机器启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 进入第二台机器，手动启动master")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-master.sh\n")])])]),s("h2",{attrs:{id:"spark执行日志持久化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark执行日志持久化"}},[a._v("#")]),a._v(" Spark执行日志持久化")]),a._v(" "),s("p",[a._v("计算层把日志持久化，history-server去获取展示")]),a._v(" "),s("p",[a._v("cd $SPARK_HOME/conf")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-defaults.conf\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 把日志持久化到hdfs上，所以先在hdfs创建存放日志的目录")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /spark_log\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /spark_log\n\nspark.eventLog.enabled "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\nspark.eventLog.dir hdfs://mycluster/spark_log\nspark.history.fs.logDirectory  hdfs://mycluster/spark_log\n")])])]),s("h3",{attrs:{id:"向其他机器分发配置-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#向其他机器分发配置-3"}},[a._v("#")]),a._v(" 向其他机器分发配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进去第一台机器 停止Spark集群")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止Spark")]),a._v("\n./stop-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入第二台机器 停止 master节点")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./stop-master.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 再次启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 进入第一台机器启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 进入第二台机器，手动启动master")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-master.sh\n\n")])])]),s("h3",{attrs:{id:"执行测试程序-查看记录的日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行测试程序-查看记录的日志"}},[a._v("#")]),a._v(" 执行测试程序，查看记录的日志")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入Spark的bin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-master/bin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用spark-shell进行测试")]),a._v("\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" spark://bigdata01:7077,bigdata02:7077\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 执行scala测试语句")]),a._v("\nsc.textFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://mycluster/sparktest/data.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".flatMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_.split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v(".map"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("((")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")])]),a._v(".reduceByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_+_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".collect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".foreach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("println"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 然后 重启Spark集群")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要想查看历史日志，在任意一台机器启动以下脚本")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-history-server.sh\n./stop-history-server.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 访问日志地址(这个结果会出现浏览器兼容性问题：360极速浏览器不好使，其他浏览器都好用)")]),a._v("\nhttp://bigdata02:18080\n")])])]),s("h3",{attrs:{id:"使用集群模式运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用集群模式运行"}},[a._v("#")]),a._v(" 使用集群模式运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/bin/spark-submit   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" spark://bigdata01:7077,bigdata02:7077 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--deploy-mode cluster "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.spark.examples.SparkPi'")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v('/examples/jars/spark-examples_2.11-2.4.5.jar"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])])]),s("h2",{attrs:{id:"spark高可用集群-on-yarn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark高可用集群-on-yarn"}},[a._v("#")]),a._v(" Spark高可用集群 On-Yarn")]),a._v(" "),s("h3",{attrs:{id:"解压到指定路径-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解压到指定路径-3"}},[a._v("#")]),a._v(" 解压到指定路径")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /opt/bigdata/spark-2.4.5-yarn\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zvxf")]),a._v(" spark-2.4.5-bin-hadoop2.7.tgz "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" /opt/bigdata/spark-2.4.5-yarn\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-yarn\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" spark-2.4.5-bin-hadoop2.7/* /opt/bigdata/spark-2.4.5-yarn/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" spark-2.4.5-bin-hadoop2.7/\n")])])]),s("h3",{attrs:{id:"设置环境变量-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量-4"}},[a._v("#")]),a._v(" 设置环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("vim/etc/profile\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SPARK_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/bigdata/spark-2.4.5-yarn\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/bin:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reboot")]),a._v("\n")])])]),s("h3",{attrs:{id:"执行配置-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行配置-2"}},[a._v("#")]),a._v(" 执行配置")]),a._v(" "),s("p",[a._v("cd $SPARK_HOME/conf")]),a._v(" "),s("blockquote",[s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" spark-env.sh.template spark-env.sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-env.sh\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("HADOOP_CONF_DIR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/bigdata/hadoop-2.8.3-ha/hadoop-2.8.3/etc/hadoop\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" spark-defaults.conf.template spark-defaults.conf\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-defaults.conf\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("spark.eventLog.enabled "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\nspark.eventLog.dir hdfs://mycluster/spark_yarn_log\nspark.history.fs.logDirectory  hdfs://mycluster/spark_yarn_log\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# hdfs创建 历史日志文件夹")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /spark_yarn_log\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /spark_yarn_log\n")])])])]),a._v(" "),s("h3",{attrs:{id:"向其他机器分发配置-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#向其他机器分发配置-4"}},[a._v("#")]),a._v(" 向其他机器分发配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-env.sh spark-defaults.conf bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-env.sh spark-defaults.conf bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-env.sh spark-defaults.conf bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])])]),s("h3",{attrs:{id:"更新yarn配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新yarn配置"}},[a._v("#")]),a._v(" 更新yarn配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$HADOOP_HOME")]),a._v("/etc/hadoop\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" yarn-site.xml\n")])])]),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("yarn.nodemanager.resource.memory-mb"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("4096"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("yarn.nodemanager.resource.cpu-vcores"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("4"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("yarn.nodemanager.vmem-check-enabled"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("false"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),s("h3",{attrs:{id:"mapreduce-的历史日志的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mapreduce-的历史日志的配置"}},[a._v("#")]),a._v(" MapReduce 的历史日志的配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$HADOOP_HOME")]),a._v("/etc/hadoop\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" mapred-site.xml\n")])])]),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mapred.job.history.server.embedded"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("true"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mapreduce.jobhistory.address"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("bigdata04:10020"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mapreduce.jobhistory.webapp.address"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("bigdata04:50060"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mapreduce.jobhistory.intermediate-done-dir"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("/work/mr-history-tmp"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mapreduce.jobhistory.done-dir"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("/work/mr-history-done"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),s("h3",{attrs:{id:"分发配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分发配置"}},[a._v("#")]),a._v(" 分发配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" yarn-site.xml mapred-site.xml bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" yarn-site.xml mapred-site.xml bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" yarn-site.xml mapred-site.xml bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])])]),s("h3",{attrs:{id:"启动hadoop集群-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动hadoop集群-2"}},[a._v("#")]),a._v(" 启动hadoop集群")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 所有机器启动zookeeper")]),a._v("\nzkServer.sh start\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看zookeeper状态")]),a._v("\nzkServer.sh status\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 resourcemanager 角色")]),a._v("\nyarn-daemons.sh start resourcemanager\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 hdfs 集群")]),a._v("\nstart-dfs.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 NodeManager 角色")]),a._v("\nstart-yarn.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 测试hadoop计算的日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/hadoop-2.8.3-ha/hadoop-2.8.3/share/hadoop/mapreduce\nhadoop jar hadoop-mapreduce-examples-2.8.3.jar wordcount /data/wc/input /data/wc/output1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动bigdata04的日志服务")]),a._v("\nmr-jobhistory-daemon.sh start historyserver\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 然后就可以在yarn上通过history链接点进去了")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("###########################################################################################")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果启动报错，全部关闭后，单个启动，然后再尝试上面的批量启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1,2,3,4")]),a._v("\nzkServer.sh start\nzkServer.sh status\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1,2,3")]),a._v("\nhadoop-daemon.sh start journalnode\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1")]),a._v("\nyarn-daemons.sh start resourcemanager\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1")]),a._v("\nyarn-daemons.sh start nodemanager\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1,2")]),a._v("\nhadoop-daemon.sh start zkfc\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1,2")]),a._v("\nhadoop-daemon.sh start namenode\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1")]),a._v("\nstart-dfs.sh\n")])])]),s("h3",{attrs:{id:"不需要再启动spark的主程序服务了-可直接运行程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不需要再启动spark的主程序服务了-可直接运行程序"}},[a._v("#")]),a._v(" 不需要再启动Spark的主程序服务了，可直接运行程序")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入Spark的bin目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-yarn/bin\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用spark-shell进行测试")]),a._v("\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 当发现启动特别慢的时候，出现以下报错时，的解决方案")]),a._v("\nWARN yarn.Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 解决方案：可以将本地spark目录下的jar包上报到hdfs上，然后更改配置文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-yarn/jars\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建hdfs目录，存放jar包")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /work/spark_lib/jars\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 上传jar包")]),a._v("\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-put")]),a._v(" ./* /work/spark_lib/jars\nhdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /work/spark_lib/jars\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入spark配置目录，编辑spark-defaults.conf文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-yarn/conf\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" spark-defaults.conf\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 增加下面这一行的配置")]),a._v("\nspark.yarn.jars  hdfs://mycluster/work/spark_lib/jars/*\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置分发")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata02:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata03:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" spark-defaults.conf bigdata04:"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])])]),s("h3",{attrs:{id:"在spark集群环境上测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在spark集群环境上测试"}},[a._v("#")]),a._v(" 在Spark集群环境上测试")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 再次使用spark-shell进行测试（只能在客户端执行）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/bigdata/spark-2.4.5-yarn/bin\n./spark-shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v("\n\nsc.textFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://mycluster/sparktest/data.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".flatMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_.split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v(".map"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("((")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")])]),a._v(".reduceByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_+_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".collect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".foreach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("println"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要想查看历史日志，在04机器启动以下脚本")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/sbin\n./start-history-server.sh\n./stop-history-server.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用集群模式运行")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v("/bin/spark-submit   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--master")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--deploy-mode cluster "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.spark.examples.SparkPi'")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SPARK_HOME")]),a._v('/examples/jars/spark-examples_2.11-2.4.5.jar"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])])]),s("h3",{attrs:{id:"启动集群总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动集群总结"}},[a._v("#")]),a._v(" 启动集群总结")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 所有机器启动zookeeper")]),a._v("\nzkServer.sh start\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看zookeeper状态")]),a._v("\nzkServer.sh status\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 resourcemanager 角色")]),a._v("\nyarn-daemons.sh start resourcemanager\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 hdfs 集群")]),a._v("\nstart-dfs.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 yarn 的 NodeManager 角色")]),a._v("\nstart-yarn.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动hadoop的日志服务（在04机器上）")]),a._v("\nmr-jobhistory-daemon.sh start historyserver\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动Spark的日志服务（在04机器上）")]),a._v("\nstart-history-server.sh\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);